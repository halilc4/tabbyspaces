//- Inline workspace editor
.workspace-editor-inline
  .editor-body
    ng-container(*ngTemplateOutlet='editorContent')

  .editor-footer
    label.startup-checkbox
      input(type='checkbox', [(ngModel)]='workspace.launchOnStartup')
      |  Launch on startup
    .editor-actions
      button.btn.btn-secondary.btn-sm(type='button', (click)='onCancel()') Cancel
      button.btn.btn-primary.btn-sm(type='button', (click)='onSave()', [disabled]='!workspace.name?.trim() || !hasUnsavedChanges')
        i.fas.fa-save
        |  Save
        span.unsaved-indicator(*ngIf='hasUnsavedChanges') *

//- Shared editor content
ng-template(#editorContent)
  //- Top row: Color picker, Name input, Icon grid
  .editor-top-row
    .color-picker
      input.color-input(
        type='color',
        [(ngModel)]='workspace.color',
        title='Workspace color'
      )

    input.name-input(
      #nameInput,
      type='text',
      [(ngModel)]='workspace.name',
      placeholder='Name your workspace'
    )

    .icon-picker
      button.icon-trigger(
        type='button',
        [style.color]='workspace.color',
        (click)='toggleIconDropdown()',
        title='Select icon'
      )
        i.fas([class]='"fa-" + workspace.icon')

      .icon-dropdown(*ngIf='iconDropdownOpen')
        button.icon-option(
          *ngFor='let icon of availableIcons',
          type='button',
          [class.selected]='workspace.icon === icon',
          [style.color]='workspace.icon === icon ? workspace.color : null',
          (click)='selectIcon(icon)'
        )
          i.fas([class]='"fa-" + icon')

  //- Layout section
  .layout-section
    .layout-header
      span.layout-title Layout

    .layout-toolbar
      .toolbar-group.split-group
        span.toolbar-label Split
        button.toolbar-btn(
          type='button',
          [disabled]='!selectedPaneId',
          (click)='splitSelectedPane("horizontal")',
          title='Split Horizontal'
        )
          i.fas.fa-arrows-alt-h
        button.toolbar-btn(
          type='button',
          [disabled]='!selectedPaneId',
          (click)='splitSelectedPane("vertical")',
          title='Split Vertical'
        )
          i.fas.fa-arrows-alt-v

      .toolbar-divider

      .toolbar-group.add-group
        span.toolbar-label Add
        button.toolbar-btn(
          type='button',
          [disabled]='!selectedPaneId',
          (click)='addPane("left")',
          title='Add Left'
        )
          i.fas.fa-caret-left
        button.toolbar-btn(
          type='button',
          [disabled]='!selectedPaneId',
          (click)='addPane("right")',
          title='Add Right'
        )
          i.fas.fa-caret-right
        button.toolbar-btn(
          type='button',
          [disabled]='!selectedPaneId',
          (click)='addPane("top")',
          title='Add Top'
        )
          i.fas.fa-caret-up
        button.toolbar-btn(
          type='button',
          [disabled]='!selectedPaneId',
          (click)='addPane("bottom")',
          title='Add Bottom'
        )
          i.fas.fa-caret-down

      .toolbar-spacer

      .toolbar-group
        button.toolbar-btn.danger(
          type='button',
          [disabled]='!selectedPaneId || !canRemovePane()',
          (click)='removeSelectedPane()',
          title='Remove pane'
        )
          i.fas.fa-trash

    .layout-preview-container((click)='onPreviewBackgroundClick()')
      split-preview(
        [split]='workspace.root',
        [selectedPaneId]='selectedPaneId',
        [profiles]='profiles',
        (paneSelect)='selectPane($event)',
        (paneEdit)='editPane($event)',
        (splitHorizontal)='splitPane($event, "horizontal")',
        (splitVertical)='splitPane($event, "vertical")',
        (addLeft)='addPaneFromEvent($event, "left")',
        (addRight)='addPaneFromEvent($event, "right")',
        (addTop)='addPaneFromEvent($event, "top")',
        (addBottom)='addPaneFromEvent($event, "bottom")',
        (removePane)='removePane($event)'
      )

//- Pane editor (always modal)
pane-editor(
  *ngIf='showPaneEditor && editingPane',
  [pane]='editingPane',
  [profiles]='profiles',
  (save)='onPaneSave($event)',
  (cancel)='closePaneEditor()'
)
